<%@ page language="java" contentType="text/plain; charset=UTF-8"
    pageEncoding="UTF-8" trimDirectiveWhitespaces="true"%>

<%@page import="java.sql.*"%>
<%@page import="javax.xml.parsers.*"%>
<%@page import="org.w3c.dom.*"%>
<%@page import="java.io.*"%>
<%

String url = "jdbc:mysql://localhost:3306/project;
String user = "projcet";
String password = "1234";

Connection conn = DriverManager.getConnection(url, user, password);
Statement stmt = conn.createStatement();
String sql = "SELECT * FROM books";
ResultSet rs = stmt.executeQuery(sql);

DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
Document doc = builder.newDocument();
Element rootElement = doc.createElement("books");
doc.appendChild(rootElement);

while(rs.next()) {
	Element book = doc.createElement("book");

	Element name = doc.createElement("name");
	name.appendChild(doc.createTextNode(rs.getString("name")));
	book.appendChild(name);

	Element publisher = doc.createElement("publisher");
	publisher.appendChild(doc.createTextNode(rs.getString("publisher")));
	book.appendChild(publisher);

	Element author = doc.createElement("author");
	author.appendChild(doc.createTextNode(rs.getString("author")));
	book.appendChild(author);

	Element price = doc.createElement("price");
	price.appendChild(doc.createTextNode(rs.getString("price")));
	book.appendChild(price);

	rootElement.appendChild(book);
}

TransformerFactory transformerFactory = TransformerFactory.newInstance();
Transformer transformer = transformerFactory.newTransformer();
DOMSource source = new DOMSource(doc);
StreamResult result = new StreamResult(new StringWriter());
transformer.transform(source, result);

String xmlString = result.getWriter().toString();
out.println(xmlString);
%>   